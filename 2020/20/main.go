package main

import (
	"bytes"
	"fmt"
	"math"
	"math/bits"
	"strings"
)

func main() {
	tiles := parseInput(input)

	run(tiles)
}

func run(tiles []tile) {
	// I'm going to guess I've got 4 rotations and 4 flipped rotations and
	// that's it.

	// So I've placed my corners. Need to layout the tiles.
	// Explore states, with aim of getting all the tiles into a valid state
	w := world{
		w:         int(math.Sqrt(float64(len(tiles)))),
		remaining: tiles,
	}

	valid := w.findValid()
	if valid == nil {
		fmt.Println("failed to find solution")
		return
	}

	fmt.Println(valid[0].n, valid[w.w-1].n, valid[w.w*w.w-w.w].n, valid[w.w*w.w-1].n)
	fmt.Println(valid[0].n * valid[w.w-1].n * valid[w.w*w.w-w.w].n * valid[w.w*w.w-1].n)

	// Now remove the edges to build an arena
	sqq := make([]square, 0, len(valid))
	for i := range valid {
		t := &valid[i]
		t.flipBody()
		t.rotateBody()
		t.body.trim()
		sqq = append(sqq, t.body)
	}

	asq := join(sqq)

	// Finally we can look for seamonsters. Could do bitmasks but at this point...
	// Of course we might need to flip/rotate everything!
	// Could turn into vectors and move across the arena. Then rotate/flip the vectors
	seamonster :=
		strings.Split(`                  # 
#    ##    ##    ###
 #  #  #  #  #  #   `, "\n")
	var vsea []vec
	for y, line := range seamonster {
		for x, c := range line {
			if c == '#' {
				vsea = append(vsea, vec{x, y})
			}
		}
	}

SEARCH:
	for i := 0; i < 2; i++ {
		for j := 0; j < 4; j++ {
			// Show the arena
			asq.print()

			// Find the monsters
			var count int
			for y := 0; y < asq.w; y++ {
				for x := 0; x < asq.w; x++ {
					found := true
					for _, v := range vsea {
						x := x + v[0]
						y := y + v[1]
						if x < 0 || x >= asq.w || y < 0 || y >= asq.w {
							found = false
							break
						}
						p := y*asq.w + x
						if asq.data[p] != '#' {
							found = false
							break
						}
					}
					if found {
						fmt.Println("found")
						count++
					}
				}
			}
			if count == 0 {
				fmt.Printf("need to flip or rotate\n\n")
			} else {
				fmt.Printf("found %d monsters\n\n", count)
				var hc int
				for _, c := range asq.data {
					if c == '#' {
						hc++
					}
				}
				fmt.Println(hc, count*len(vsea), hc-count*len(vsea))

				break SEARCH
			}

			asq.rotate()
		}
		asq.flip()
	}
}

type world struct {
	w         int
	placed    []tile
	remaining []tile
}

type square struct {
	data []byte
	w    int
}

func (s *square) rotate() {
	nd := make([]byte, len(s.data))
	for i, c := range s.data {
		x := i % s.w
		y := i / s.w
		x, y = s.w-y-1, x
		nd[y*s.w+x] = c
	}
	s.data = nd
}
func (s *square) flip() {
	for i := 0; i < len(s.data); i += s.w {
		sl := s.data[i : i+s.w]
		for j := 0; j < s.w/2; j++ {
			sl[j], sl[len(sl)-j-1] = sl[len(sl)-j-1], sl[j]
		}
	}
}

func (s *square) trim() {
	data := s.data[:0]
	for i := s.w; i < len(s.data)-s.w; i += s.w {
		data = append(data, s.data[i+1:i+s.w-1]...)
	}
	s.w -= 2
	s.data = data
}

func (s square) print() {
	for i := 0; i < len(s.data); i += s.w {
		fmt.Println(string(s.data[i : i+s.w]))
	}
}

func join(sqq []square) square {
	ww := int(math.Sqrt(float64(len(sqq))))
	fsq := square{w: ww * sqq[0].w}
	data := make([]byte, fsq.w*fsq.w)
	for i, sq := range sqq {
		// coords of the top left of this tile
		x := (i % ww) * sq.w
		y := (i / ww) * sq.w
		for i, c := range sq.data {
			tx, ty := i%sq.w, i/sq.w
			x, y := x+tx, y+ty
			data[y*fsq.w+x] = c
		}
	}
	fsq.data = data
	return fsq
}

type vec [2]int

func (w world) isValidNext(t tile) bool {
	x := len(w.placed) % w.w
	y := len(w.placed) / w.w
	for _, vec := range []vec{{1, 0}, {-1, 0}, {0, 1}, {0, -1}} {
		xp := x + vec[0]
		yp := y + vec[1]
		if yp < 0 || yp >= w.w {
			continue
		}
		if xp < 0 || xp >= w.w {
			continue
		}
		cp := (yp * w.w) + xp
		if cp >= len(w.placed) {
			continue
		}
		ct := w.placed[cp]
		switch {
		case xp < x:
			if ct.edges[right] != t.edges[left] {
				return false
			}
		case xp > x:
			if ct.edges[left] != t.edges[right] {
				return false
			}
		case yp > y:
			if ct.edges[top] != t.edges[bottom] {
				return false
			}
		case yp < y:
			if ct.edges[bottom] != t.edges[top] {
				return false
			}
		}
	}
	return true
}

func (w world) findValid() []tile {
	if len(w.remaining) == 0 {
		return w.placed
	}
	for ri, tile := range w.remaining {
		for j := 0; j < 2; j++ {
			for i := 0; i < 4; i++ {
				if w.isValidNext(tile) {
					wp := w.addTile(ri, tile)
					if valid := wp.findValid(); valid != nil {
						return valid
					}
				}
				tile = tile.rotate()
			}
			tile = tile.flip()
		}
	}
	return nil
}

func (w world) addTile(ri int, t tile) world {
	// Can't just append as we might append many tiles to the same slice
	placed := make([]tile, len(w.placed)+1)
	copy(placed, w.placed)
	placed[len(placed)-1] = t
	w.placed = placed
	// Same with remaining
	remaining := make([]tile, len(w.remaining)-1)
	copy(remaining, w.remaining[:ri])
	copy(remaining[ri:], w.remaining[ri+1:])
	w.remaining = remaining
	return w
}

func reverseEdge(edge int16) int16 {
	r := bits.Reverse16(uint16(edge))
	return int16(r >> 6)
}

func parseInput(input string) []tile {
	tiles := strings.Split(input, "\n\n")
	fmt.Printf("%d tiles\n", len(tiles))

	tt := make([]tile, len(tiles))

	for i, tile := range tiles {
		tt[i] = parseTile(tile)
	}
	return tt
}

func parseTile(in string) tile {
	lines := bytes.Split([]byte(in), []byte("\n"))
	var t tile
	fmt.Sscanf(string(lines[0]), "Tile %d:", &t.n)
	lines = lines[1:]
	t.edges[0] = lineToInt(lines[0])
	t.edges[2] = lineToInt(lines[len(lines)-1])
	for i, line := range lines {
		t.edges[1] |= charToBit(line[len(line)-1]) << i
		t.edges[3] |= charToBit(line[0]) << i
	}
	t.body.data = bytes.Join(lines, nil)
	t.body.w = int(math.Sqrt(float64(len(t.body.data))))
	return t
}

func charToBit(c byte) int16 {
	if c == '#' {
		return 1
	}
	return 0
}

func lineToInt(line []byte) (v int16) {
	for i, n := range line {
		v |= charToBit(byte(n)) << i
	}
	return v
}

type edge int

const (
	top edge = iota
	right
	bottom
	left
)

type tile struct {
	n int
	// 0 top
	// 1 right
	// 2 bottom
	// 3 left
	// bits are left to right or top to bottom
	edges   [4]int16
	angle   int
	flipped bool
	body    square
}

func (t tile) rotate() tile {
	t.edges[top], t.edges[right], t.edges[bottom], t.edges[left] =
		reverseEdge(t.edges[left]), t.edges[top], reverseEdge(t.edges[right]), t.edges[bottom]
	t.angle += 90
	if t.angle == 360 {
		t.angle = 0
	}
	return t
}

func (t tile) flip() tile {
	t.edges[top], t.edges[right], t.edges[bottom], t.edges[left] =
		reverseEdge(t.edges[top]), t.edges[left], reverseEdge(t.edges[bottom]), t.edges[right]
	t.flipped = !t.flipped
	return t
}

func (t *tile) flipBody() {
	if t.flipped {
		t.body.flip()
		t.flipped = false
	}
}

func (t *tile) rotateBody() {
	if t.angle == 0 {
		return
	}
	for i := 0; i < t.angle/90; i++ {
		t.body.rotate()
	}
	t.angle = 0
}

var testInput = `Tile 2311:
..##.#..#.
##..#.....
#...##..#.
####.#...#
##.##.###.
##...#.###
.#.#.#..##
..#....#..
###...#.#.
..###..###

Tile 1951:
#.##...##.
#.####...#
.....#..##
#...######
.##.#....#
.###.#####
###.##.##.
.###....#.
..#.#..#.#
#...##.#..

Tile 1171:
####...##.
#..##.#..#
##.#..#.#.
.###.####.
..###.####
.##....##.
.#...####.
#.##.####.
####..#...
.....##...

Tile 1427:
###.##.#..
.#..#.##..
.#.##.#..#
#.#.#.##.#
....#...##
...##..##.
...#.#####
.#.####.#.
..#..###.#
..##.#..#.

Tile 1489:
##.#.#....
..##...#..
.##..##...
..#...#...
#####...#.
#..#.#.#.#
...#.#.#..
##.#...##.
..##.##.##
###.##.#..

Tile 2473:
#....####.
#..#.##...
#.##..#...
######.#.#
.#...#.#.#
.#########
.###.#..#.
########.#
##...##.#.
..###.#.#.

Tile 2971:
..#.#....#
#...###...
#.#.###...
##.##..#..
.#####..##
.#..####.#
#..#.#..#.
..####.###
..#.#.###.
...#.#.#.#

Tile 2729:
...#.#.#.#
####.#....
..#.#.....
....#..#.#
.##..##.#.
.#.####...
####.#.#..
##.####...
##..#.##..
#.##...##.

Tile 3079:
#.#.#####.
.#..######
..#.......
######....
####.#..#.
.#...#.##.
#.#####.##
..#.###...
..#.......
..#.###...`

var input = `Tile 2131:
###..#...#
##..#.##.#
..###...#.
......#..#
##.#.....#
..#..#...#
......#...
......#...
.........#
#.##..#.##

Tile 2441:
..#.#.....
#.#.......
..........
...#.#....
....###.#.
#....#...#
#.#...#...
#...#.....
#...#....#
.##.#.#..#

Tile 1571:
....#....#
...#...##.
.#.....#..
....#..#..
#....##.##
###..#....
....#.#.#.
..#....#..
#...###..#
#.########

Tile 2179:
#####..#.#
##......##
#.....#.#.
#...#....#
.....#.#..
####.....#
.#..#.#..#
##..###...
##.....##.
..#.####.#

Tile 1433:
#....#..##
#.##...#..
.........#
#..#....#.
#......#..
.#.....###
#......###
#..#..#...
.........#
.#.#.#....

Tile 1283:
...#.##...
##.......#
#..#.....#
.####.##..
..#..#.###
#.....#...
.##..##.##
#........#
..........
#.##......

Tile 1667:
.#####.#.#
...#.....#
##...#...#
#..#....#.
.........#
...##..#.#
...#..#..#
#.#.....##
#.........
#..#..####

Tile 1657:
##.#.#..##
#.....#.#.
#........#
....#....#
......#...
......#..#
#..#.....#
.##.......
#...#.##.#
.#.##..##.

Tile 1259:
..#.....##
##.......#
.......#.#
#..#.....#
.#..#.....
#.#..##..#
.##.....##
##.......#
##...#....
########..

Tile 2161:
.#.#.###.#
....##.#..
..##.#...#
....#.#..#
#.........
.#.#......
#.#.......
#.##.....#
##.##....#
.#######.#

Tile 3793:
.##.##..##
#.........
........#.
.#.......#
.......#.#
.#.......#
#.......##
....#....#
#.#.......
####..##.#

Tile 2953:
....####..
#..#...##.
.........#
.#...#..##
..#..#.#..
..........
#.........
....##.#..
##..###.#.
...####.##

Tile 1979:
.####.###.
.....#.##.
##..#.#..#
.##..#.###
#..#..#..#
.#...####.
#....##..#
###.#...##
.#...##..#
.##.#..##.

Tile 3061:
...####..#
#...#....#
..#...#...
#.##......
.........#
#.#.......
#........#
.....#....
#.#......#
.##....#..

Tile 2731:
..#...##.#
#......#.#
.....##...
.....##..#
#.##.#..#.
##....##..
..........
#........#
.........#
##..#...#.

Tile 1439:
..###.####
....##...#
........##
.........#
#.......##
..##...#.#
....#.#..#
......#...
#.##.#.#.#
##.##...##

Tile 3347:
..#.##.###
...#...#.#
#.#.#...#.
#..#...###
.##....#..
##........
##.#..#..#
..#....#..
..##..#.#.
..#######.

Tile 1559:
###.#.####
#.......#.
#.......#.
..#.##..#.
..#.....#.
#...#..#.#
#..#....##
#.##......
#.#..#...#
.#..#####.

Tile 3559:
...##.##..
#........#
..##......
#...#.....
##.#..##..
#.........
#.#....#.#
#.........
....#....#
#...#.###.

Tile 3109:
.##..#....
#........#
#.....##.#
.....##.#.
#.#......#
#.##......
#......#.#
#....##..#
.#.##..###
.#.....#..

Tile 3701:
#..#..#...
..#..#...#
#.........
#.........
.....#.###
.....#....
.#..#...##
#.........
#.#.#....#
#..###..##

Tile 1597:
.##.#.#.#.
..#.#.#..#
#.......##
...#.....#
#........#
.#.......#
..#.#....#
..........
#.#.##...#
.....####.

Tile 1231:
.#####....
#....##...
##..#..#.#
...#......
#.........
#..#......
#.#...#..#
..#..#..##
#..##..#..
##.###....

Tile 3389:
.###....#.
#.......#.
#....#....
#...#....#
..#.##...#
.....##.##
..........
###...#..#
#..#.#.#..
#####..##.

Tile 3461:
....#.###.
..........
..........
...#...#.#
#....##...
..#..#....
##.#..#..#
#....#...#
...#.#...#
....######

Tile 2837:
##..#...##
#....##..#
...#....##
.#...#....
#.....#...
#.#...##.#
##..###..#
#........#
#.........
..###..#..

Tile 1423:
####.#...#
#.#......#
...#.....#
#####.#...
#..#..##..
.....##...
##.##.....
#.#....#.#
...#.....#
#.#.#..#..

Tile 3943:
#.....#..#
...##..#..
...#......
.#.#......
#...#.....
#.#.#..#..
........##
.........#
##..##.#.#
..#.#.##..

Tile 3779:
..#.#..#.#
...##...##
.......#.#
..#.....#.
..##......
#.#....###
.#.#.....#
#.........
##...#...#
#.#.##.###

Tile 1583:
##..#.##.#
..#.....#.
#..#...##.
#..#.#.#.#
.......#.#
#.##..###.
#######.#.
..#.....##
#.##....##
#..##.#.##

Tile 3041:
...#.###..
#......#..
..#....#..
.##.....##
#.#...##.#
......#.#.
..........
.#...#.#..
..#..#...#
#.##.##.#.

Tile 1889:
...#.##.#.
.#..#.....
#..#.....#
........#.
.........#
..#...#..#
###....###
#.#.......
#..#.....#
...##..#..

Tile 1493:
....##..#.
#........#
#..#......
.....#..#.
#.........
...#.....#
.........#
.#.#.....#
..........
...#######

Tile 1987:
#..#####..
#........#
###..##..#
.#....#...
......#...
#...##..##
........#.
.##.....#.
##...###..
##..##.#..

Tile 2003:
..#.#.####
##..######
#.#..#.#.#
...#.....#
#.........
......#..#
.......#.#
##........
##....#..#
..#..#.##.

Tile 1297:
.....###..
...#...#.#
...#.#...#
..........
.....#...#
#.......#.
..#.......
..#.......
....#....#
#.#######.

Tile 3049:
#..###..#.
..###...##
##........
#........#
.....#.#..
##..##..#.
#..#.#....
#.....#...
###.#.....
#..#....##

Tile 2143:
#...#.#.#.
#......#.#
#.#..#####
###..#.#..
#.##...###
....#.#.#.
#........#
..........
#...#...#.
.##.##..##

Tile 1753:
#.#.#..##.
....#.....
#...###...
#.....#.#.
#.#..###..
......#...
...#.....#
..#....#.#
#...##....
..#.#..##.

Tile 3407:
..###.##..
....#.#..#
.#...#....
....##....
#..##....#
....#.....
.....#....
.#.......#
#.....#..#
.##...#.##

Tile 1783:
.#..####..
##........
...###..##
#......#.#
#.........
..........
##........
........#.
##.####.##
.####.#.#.

Tile 3593:
#.#.....##
......#..#
##...#.#.#
#.#.#...#.
..........
.....###..
#...#.#...
###...##..
#.#...#...
..#.....##

Tile 1249:
###....##.
##..#..#.#
.#.#.##..#
..#.......
.........#
#....#.#.#
..##..#..#
###.####.#
.#.#.....#
....##...#

Tile 2963:
..##.#..#.
#..##....#
#.#..#..##
.#...####.
..#......#
##...##.#.
.........#
#....#...#
##.....#.#
####.#....

Tile 1289:
.#....#...
.##.#.....
.##.#.....
#.........
....#...##
##.......#
...#.....#
..........
..........
.#.##.#...

Tile 2053:
#.#.#...#.
....#.##.#
.........#
#.....#..#
....#.....
.##......#
#...#.#...
#...#.#...
...#..#...
#..#.#.###

Tile 3001:
.#...#...#
....##..#.
....##...#
...###...#
#..#....##
#.......#.
#.##.....#
....#.#.##
.#..##.#..
.##.....##

Tile 2591:
.####.##..
......#.##
..#......#
....#....#
..#....###
..##......
#........#
.......#.#
#....#....
##.###...#

Tile 1931:
.##..#.#..
#.........
..#......#
.#.......#
....#.....
..#.......
##...##...
#...###..#
#.#.....#.
#.#..#...#

Tile 3203:
.###.....#
...#..#..#
##........
.........#
#.#....#..
.#........
#.......##
#....####.
#.........
##....#...

Tile 1747:
#...##..##
...#.#...#
#.#......#
#....#..##
.##.......
##..#.##..
##....#..#
#...#.....
#.#....#..
.##.#.#.##

Tile 3557:
#.##..#...
#.......##
.#.#.#....
#...#.#...
#.#.##....
#...#....#
..........
#....#....
#...#.....
####..###.

Tile 3329:
#..##.....
..........
..#.......
.....##.##
....#.....
.##....#..
.....#....
..........
#####.#..#
#..#.##...

Tile 3067:
#..##....#
.#.#..#..#
..#......#
#...#....#
#.....#...
..#.#....#
#.#...#..#
.....#....
..#......#
.#.##.....

Tile 3371:
#.###..#..
#.#....#..
#....#...#
#.....#..#
..#..##..#
#.#.....#.
.#.#..####
#.#..#....
..#..#....
##......#.

Tile 3467:
#.#....#..
##....##.#
...#..####
...#.#...#
.........#
..#.......
...#...#.#
...#......
.####....#
..#.....#.

Tile 3923:
...#...##.
#........#
.#........
#.......##
#.#.#.....
.........#
....#.....
#.........
...#.#..##
#.######..

Tile 1453:
#.#...##..
##....#..#
#......#..
..........
#.#.##...#
#........#
.....#....
.##....#..
..........
#.###.###.

Tile 3331:
.##.#..#.#
.......#.#
#......#..
..#......#
#..#.....#
#..#.....#
#.#.....##
#.........
..........
####.#...#

Tile 2633:
..#.#....#
###......#
.......#.#
....#....#
###.#...#.
.#....#..#
##.....#.#
.##..#....
#...#...#.
..#...##..

Tile 1811:
#..#######
.##.....#.
#.....##.#
#..#...#..
#...#.....
##..#..#..
#.##.#..#.
.#........
##...#.#.#
.####.#..#

Tile 1777:
.####...#.
.#....#.#.
###..#....
..#..#...#
#.#.#.##..
#...#..###
#....#...#
......#...
.....#...#
####.#..##

Tile 1697:
#.##..#..#
#........#
##.####...
##......#.
#.##....#.
##..#..#..
#..#..#..#
#.....####
...#.#....
##.###.#.#

Tile 2551:
#..###..##
..#...#...
..........
.#..#.....
##.....#..
...#.#.#..
..#..##..#
.##.......
.###......
...###.##.

Tile 2351:
#...#####.
......##.#
....##...#
.........#
#.........
#.....#..#
#........#
..##.....#
....#..#..
.#.#....##

Tile 2689:
..###..###
.........#
#...#.....
##..#..#..
#.#.###...
....#....#
#........#
......#.#.
#.#..####.
####.###.#

Tile 3253:
..##......
..#.#....#
..#.#...#.
#...#.....
#..#.#....
.#....#...
....#.....
#.........
#......#..
#..#.#####

Tile 2843:
####..#...
#.....##.#
##....#...
.##..#.#..
..###.#...
...#...###
#..#..#...
.....#..##
#....#..##
...#..#.#.

Tile 1187:
.##.####.#
......#..#
...#.....#
.....#...#
.......#.#
.........#
#..#......
..#......#
#...#....#
#####...##

Tile 3529:
.....#####
.#...#....
#..#.#....
#........#
.#....#.##
##..##.#..
..##.#..##
.#........
......#..#
###..#.##.

Tile 1489:
.##.#.####
#.#..#.#..
#....#....
#.#..#....
.#...#....
..........
#.#..##..#
.........#
.......#..
.....###.#

Tile 1097:
###.###.#.
.#...#....
.......#..
.#....#.#.
.....#...#
#.#.....##
####..##.#
###......#
#........#
##..#.#.##

Tile 3491:
#...#.##..
...##....#
..#.....#.
#.#.#....#
#..#.#...#
.....#...#
....#.....
....#.#..#
........##
##....#...

Tile 3947:
######.#.#
#.#.#....#
...#.#..#.
...#.#....
#...#...##
....#.....
.......#..
##..#....#
..#..#....
.###..####

Tile 3313:
.#....#.##
.##.......
#.##......
##........
#.#.......
...#.....#
...#......
......#..#
##......#.
####.#..#.

Tile 1277:
#..###..#.
#....#...#
.##....###
#........#
#....##...
#.#...#..#
#...#....#
...#...#..
...##....#
.#...#.#.#

Tile 3121:
.#...#..##
........#.
..#..#####
#.....#.##
..#.....##
..........
#.........
#..###...#
.........#
###.#.#.#.

Tile 2287:
#....#.#.#
#.#..#....
#.....#...
..........
##.#......
##..#..###
..##....##
.....#....
#........#
..#.#...#.

Tile 1171:
#..#.#...#
..#...#...
##.......#
####...#.#
#.#.#.#...
.#.......#
##....####
#...##..#.
........#.
##.###.##.

Tile 2503:
#...#.#..#
..#..##.##
...#...###
.##.#...##
#.........
#........#
##.......#
....#.#...
...#.....#
..#...#.##

Tile 2579:
#.#..#..##
.........#
####......
..#....#..
#.#..##..#
#.....##.#
....#....#
.........#
..#..#..##
#..##.####

Tile 1867:
.##.....#.
.........#
.#....#.#.
#....#..##
##........
...#......
#....##..#
##..##.#.#
#.........
####..##.#

Tile 2081:
.##..#...#
......###.
..##.#..##
##..##....
#..#.#...#
....#...#.
##.....#.#
..#....#..
#...#...##
.####..#.#

Tile 3319:
..#...#.#.
.....#....
.#........
#.......#.
#.........
.....#...#
#.....###.
#........#
........##
#...#####.

Tile 3727:
##.#.#...#
#.........
..##.....#
#...#.#...
#.#.#...#.
.###.#....
......#.##
#...#....#
...#.#...#
#..#.#..##

Tile 1103:
###.##.#..
.#..#.##..
.#..###.#.
#.#..##.#.
.##...##.#
....#....#
....#..#.#
...#...###
...#..#.#.
###.#..##.

Tile 3463:
##...#.#.#
....#..##.
........##
.#.......#
..#..#....
#.#....#..
##....#..#
...#..#..#
#.#......#
#.###..##.

Tile 3449:
..###.##..
..#..#....
#...##....
.####..###
.#..###.##
#.#....##.
......#..#
..........
##........
#.......#.

Tile 2207:
#...#.#.#.
.##.....#.
#####....#
..#.#.....
#..#....##
.#....##.#
#....#.#.#
...#....#.
..#.#.....
##..#.##.#

Tile 2647:
.#####..#.
.#..#....#
....#.#..#
.##.......
...#..###.
####...###
##.....#.#
#..#.....#
#.#.....##
..##.##..#

Tile 2539:
##..#..###
...#..#..#
.#....#...
###....#..
.#...#....
...##.....
..#..##.#.
...#......
#...#....#
#.#.##....

Tile 2927:
.#.....##.
#.......#.
#..##..##.
#...#.....
....#...##
.#.#.#..##
........##
###.#...#.
...#.....#
.##.....##

Tile 2153:
#.#..##..#
...#.####.
#..##.....
.........#
#.....#..#
...##.....
...#...###
..##..####
...#...###
##.#.##.##

Tile 3083:
###.#..#.#
...#.....#
#.......##
..#......#
...#.....#
..........
..#......#
.##....#..
#......###
..#......#

Tile 1237:
.#....###.
#.........
#...#...##
.....#.#..
#.........
....#..#..
........##
##......#.
#.........
#..##.#...

Tile 2239:
#.....##.#
##........
....##....
#.##....##
###.#..###
#........#
.........#
#..#.#.#..
.........#
.#..#.....

Tile 1093:
.####..#..
##....#...
..#.#...##
...#..#...
#........#
#...#.#..#
#.#####..#
....#.#...
#.#.#..#.#
#.#..#####

Tile 2221:
......#.#.
....#..#.#
#..#...#.#
.#........
#........#
##....##.#
##.....#.#
##...#...#
#..#..#...
..##....#.

Tile 1523:
##.###.###
###..#..#.
#..##...##
#..#.#....
#..#.....#
#.#......#
#.......#.
#.........
.#.###.##.
...#.#...#

Tile 3673:
###.##..#.
..........
.#.......#
#..#.##...
......#..#
#.....##..
##....#..#
..#...#...
#...#...#.
#####...##

Tile 2063:
####.....#
#........#
......#..#
#.#..#....
#.#.....#.
...#.....#
#...##..#.
#.....#...
......#.##
..##.#.##.

Tile 3631:
#.#.#.####
...#.#....
...#.#...#
#....#.#..
#..#...###
#.##......
#..#...###
#.#.#..#..
.......##.
.#.#......

Tile 2693:
###.####.#
...#......
....#.#..#
#.#..#....
.....###.#
#....#....
##.###....
#.....#..#
#.....#...
######.#.#

Tile 2593:
###.....##
.....#....
..#...#...
.....#...#
..##......
###.......
.##......#
#....#...#
#..#..#..#
#.###.#.#.

Tile 3607:
.##.##.#..
#...#..##.
....#..#..
#......#.#
..........
..........
.......#..
#....##..#
.......#.#
.#####....

Tile 1223:
.####..#.#
......##..
.........#
...#....#.
#....#.#..
##.#...#..
.#......##
.........#
#.#.#....#
##.#..#..#

Tile 3433:
##.###..##
#..#.##...
##....#..#
#.........
###.##.#.#
....##....
#...#.#..#
...#......
##....#..#
##.#.#...#

Tile 1217:
#..###.###
#.#...#...
..#.##....
#.......#.
#.......#.
##...#..##
#..#..#...
#..####..#
#...##...#
.####.###.

Tile 2861:
#..##.#.#.
#...#.##..
.#...####.
.......#.#
..#...#..#
#...##...#
#.....#.#.
......##.#
##..#.##..
###..####.

Tile 1327:
....#.####
...####...
....#.#...
..#...#.#.
....#....#
..#..#...#
....##....
......#...
#....##.##
##.######.

Tile 3613:
#.##.###..
#..#..#..#
..##.##...
..#..#####
...###..##
#...#.#.##
#....#....
...#.....#
.###.#..##
####...###

Tile 2909:
#####..#..
#...#..#..
#.#....#..
..#.......
...##...#.
.#.##..###
...#.....#
.........#
...#.##..#
#######.##

Tile 1709:
#.#.##....
#......#.#
.#........
#......#..
.........#
......#.#.
..##......
.....#....
..#.##....
#....#####

Tile 2857:
###.#...##
#.#....#..
........##
#.#...#..#
#......#..
.....####.
......#..#
..........
#.#.....##
..#..##...

Tile 3541:
#.#.##.###
.....##..#
..#.#.....
#..#.....#
##....#...
#.#...#...
....##....
.........#
.##....#.#
...#.....#

Tile 2459:
##..#.#..#
...#.#.##.
##...#....
.##.#.#...
#.....#..#
...#.....#
......#...
.....##...
...##...#.
..#..###..

Tile 1621:
#.##.###..
##..#.#...
.#.##...##
.###.#..##
.#..##.#..
#.......##
.....##...
..#.......
#.........
#..#..###.

Tile 3833:
#..#...###
.........#
#.....#...
#..#...#.#
#......#..
.#........
..#.......
.........#
......##.#
.#..#.#.##

Tile 1117:
..##.....#
..##......
#..#.#...#
#...##..##
....#...#.
#...#....#
....#..#.#
...#.....#
#..#.....#
..#.##..##

Tile 3413:
#.#..#.###
....##.#.#
...#.....#
.........#
#.........
.....##.##
..#....#..
#.....##..
#........#
#.######..

Tile 2141:
.##.#..#.#
#.###.....
#..#....#.
#..#....#.
..#.......
.#.....#.#
##......#.
..#..#.###
...#.....#
...#..#..#

Tile 3547:
####.#..##
...#.#...#
......#...
##.#......
#........#
.##...#..#
.#...#..##
#..#..#...
#.##......
##.###..#.

Tile 1069:
##.#..##.#
.#....#..#
.##......#
.#....#.##
#..#..#...
..#.#.....
..........
#....#..#.
##........
..#...##.#

Tile 3169:
##.##.#..#
#.....####
.##...##..
#....#.#.#
#.#..##...
#........#
.#.......#
.#........
.........#
#..#...#.#

Tile 1307:
..##..#.##
###.#...##
..##.....#
#.##.....#
.....#.#..
..#....#..
....#...#.
.....#..##
.#.....#.#
##.#.....#

Tile 3359:
#.#.#..#..
........#.
.#...#...#
#....##..#
.#.#......
#...#.#.#.
.#...###.#
#........#
.#.#.....#
###.#..#..

Tile 2713:
#...#...##
##.###.#..
..##....#.
...#.....#
..#.....#.
#....#...#
....#.....
#..##....#
.........#
#######..#

Tile 2897:
...####..#
...#...#.#
#.......#.
......#...
.....#...#
.........#
.#.#......
######..##
...#..#..#
#..###.###

Tile 3929:
....#.#.#.
.#...#....
#.##..###.
..##......
#.##...#..
#...#.....
.......###
#.##.....#
#...#.....
...#######

Tile 1031:
#####.#.#.
#....##.#.
#..#..#..#
.........#
##.#...#.#
....#...#.
.......#..
#......#..
......#..#
.#.....#.#

Tile 1361:
#.#.#.....
.#........
..##...#.#
#..##.#..#
.....#####
.......##.
#........#
..........
#..#...#.#
##.###.#.#

Tile 3853:
#..##.....
.........#
#..#......
#.........
###.....#.
...#.#...#
#.........
..........
..........
##.##.####

Tile 1009:
...#.#...#
..##....#.
.......#..
.....#...#
#..#...#.#
.#..#..#..
..##.#..#.
....#.#..#
#..#.#....
###.#.####

Tile 3761:
.##.#.#.#.
..#......#
#....##...
.#........
#...#..#.#
.........#
#.........
.........#
.#.......#
#..#......

Tile 2521:
.#.....###
#........#
...##....#
###.......
#....#....
###..#...#
##....#..#
.#........
.........#
#..#...###

Tile 1907:
.####.#..#
...#..#..#
#.#..##.##
##....##.#
#........#
#...#.....
#.........
#.#..#...#
##....###.
.##.###.#.

Tile 2039:
...##..###
###...#...
.#.......#
...##.#...
.........#
......#..#
#........#
###....#.#
#.#......#
#..#...#..

Tile 2389:
##.##.###.
#.#.......
........##
.........#
...#......
..........
#...#..#.#
#.......#.
....#..###
####.###.#

Tile 2089:
#.#..#.#.#
#........#
.#.....#..
..........
#....#...#
#........#
#.........
#.........
#...#.....
#.#...#..#

Tile 2137:
.#####..##
..#......#
#.#..#....
.#......#.
#...#.....
......#...
....##..#.
.##....#.#
#..#..#..#
#..####.##

Tile 3191:
..###....#
.........#
........##
....#..#..
.........#
#.........
..#..#..#.
.#....###.
#.....#..#
#..#####.#

Tile 2789:
#.#.#.##.#
...#.....#
#..###...#
#........#
##.......#
#..##....#
.#........
.........#
..#......#
......#..#

Tile 1567:
....#....#
#..##..##.
.....#....
#.##.##...
....##....
##...#...#
#.#.#....#
......###.
..#.#..#.#
.#..##.#.#

Tile 1163:
.###..##..
.#.....#.#
#...###..#
.....#....
.........#
..#...#..#
..#..##.##
.##..###.#
.........#
##.##..#.#`
